# üìä API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: Dashboard Summary

## Endpoint

```
GET /api/v1/reports/dashboard/summary
```

## –û–ø–∏—Å–∞–Ω–∏–µ

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é —Å–≤–æ–¥–∫—É –ø–æ –¥–µ–±–∏—Ç–æ—Ä—Å–∫–æ–π –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏, –≤–∫–ª—é—á–∞—è:
- –û–±—â—É—é –∏ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—É—é –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å
- –°—Ç—Ä—É–∫—Ç—É—Ä—É —Å—Ç–∞—Ä–µ–Ω–∏—è (aging buckets)
- –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç–∏ –î–ó
- –ú–µ—Ç—Ä–∏–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π

---

## –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

**–¢—Ä–µ–±—É–µ—Ç—Å—è**: Bearer Token (JWT)

**–ó–∞–≥–æ–ª–æ–≤–æ–∫**:
```
Authorization: Bearer YOUR_JWT_TOKEN
```

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω**:
```bash
POST /api/v1/auth/login
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password"
}
```

**–û—Ç–≤–µ—Ç**:
```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": { ... }
}
```

---

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

**–ù–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É.

---

## –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞

### –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200 OK)

```json
{
  "totalReceivables": 1250600.75,
  "overdueReceivables": 315200.50,
  "overduePercentage": 25.2,
  "currentReceivables": 935400.25,
  "averagePaymentDelayDays": 15.5,
  "totalInvoicesCount": 42,
  "overdueInvoicesCount": 18,
  "agingStructure": [
    {
      "bucket": "Current",
      "amount": 935400.25,
      "count": 24
    },
    {
      "bucket": "1-30",
      "amount": 125000.00,
      "count": 8
    },
    {
      "bucket": "31-60",
      "amount": 95000.50,
      "count": 5
    },
    {
      "bucket": "61-90",
      "amount": 55200.00,
      "count": 3
    },
    {
      "bucket": "91+",
      "amount": 40000.00,
      "count": 2
    }
  ],
  "averageReceivables": 250000.00,
  "turnoverRatio": 4.5,
  "periodRevenue": 1125000.00,
  "averagePaymentDays": 28.5,
  "onTimePaymentsAmount": 850000.00,
  "overduePaymentsPercentage": 15.3
}
```

### –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (401 Unauthorized)

```json
{
  "status": "fail",
  "message": "–û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: —Ç–æ–∫–µ–Ω –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω."
}
```

### –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (500 Internal Server Error)

```json
{
  "status": "error",
  "message": "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ —Å–≤–æ–¥–∫–∏ –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞"
}
```

---

## –û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª–µ–π –æ—Ç–≤–µ—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –î–ó

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------|-----|----------|--------|
| `totalReceivables` | number | –û–±—â–∞—è —Å—É–º–º–∞ —Ç–µ–∫—É—â–µ–π –¥–µ–±–∏—Ç–æ—Ä—Å–∫–æ–π –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏ (–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏ –ø–æ –≤—Å–µ–º —Å—á–µ—Ç–∞–º) | `1250600.75` |
| `overdueReceivables` | number | –°—É–º–º–∞ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω–æ–π –¥–µ–±–∏—Ç–æ—Ä—Å–∫–æ–π –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏ (—Å—á–µ—Ç–∞, –≥–¥–µ `dueDate < —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞`) | `315200.50` |
| `overduePercentage` | number | –ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω–æ–π –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏ –æ—Ç –æ–±—â–µ–π (`overdueReceivables / totalReceivables √ó 100`) | `25.2` |
| `currentReceivables` | number | –°—É–º–º–∞ –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Å—Ä–æ–∫ (–Ω–µ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω–æ–π) (`totalReceivables - overdueReceivables`) | `935400.25` |

### –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø—Ä–æ—Å—Ä–æ—á–∫–∏

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------|-----|----------|--------|
| `averagePaymentDelayDays` | number | –°—Ä–µ–¥–Ω–∏–π —Å—Ä–æ–∫ –∑–∞–¥–µ—Ä–∂–∫–∏ –æ–ø–ª–∞—Ç—ã (–≤ –¥–Ω—è—Ö) –¥–ª—è –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö —Å—á–µ—Ç–æ–≤ | `15.5` |
| `totalInvoicesCount` | number | –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö —Å—á–µ—Ç–æ–≤ (`status != 'PAID'` –∏ `outstandingAmount > 0`) | `42` |
| `overdueInvoicesCount` | number | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö —Å—á–µ—Ç–æ–≤ (`dueDate < —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞`) | `18` |

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç–∞—Ä–µ–Ω–∏—è (Aging Structure)

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `agingStructure` | array | –ú–∞—Å—Å–∏–≤ –∫–æ—Ä–∑–∏–Ω —Å—Ç–∞—Ä–µ–Ω–∏—è –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏ |

**–ö–æ—Ä–∑–∏–Ω—ã —Å—Ç–∞—Ä–µ–Ω–∏—è**:

| Bucket | –û–ø–∏—Å–∞–Ω–∏–µ | –£—Å–ª–æ–≤–∏–µ |
|--------|----------|---------|
| `Current` | –í —Å—Ä–æ–∫ (–Ω–µ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–æ) | `dueDate >= —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞` |
| `1-30` | –ü—Ä–æ—Å—Ä–æ—á–∫–∞ 1-30 –¥–Ω–µ–π | `1 <= daysOverdue <= 30` |
| `31-60` | –ü—Ä–æ—Å—Ä–æ—á–∫–∞ 31-60 –¥–Ω–µ–π | `31 <= daysOverdue <= 60` |
| `61-90` | –ü—Ä–æ—Å—Ä–æ—á–∫–∞ 61-90 –¥–Ω–µ–π | `61 <= daysOverdue <= 90` |
| `91+` | –ü—Ä–æ—Å—Ä–æ—á–∫–∞ –±–æ–ª–µ–µ 90 –¥–Ω–µ–π | `daysOverdue > 90` |

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫–æ—Ä–∑–∏–Ω—ã**:
```json
{
  "bucket": "1-30",
  "amount": 125000.00,  // –°—É–º–º–∞ –î–ó –≤ —ç—Ç–æ–π –∫–æ—Ä–∑–∏–Ω–µ
  "count": 8            // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—á–µ—Ç–æ–≤ –≤ —ç—Ç–æ–π –∫–æ—Ä–∑–∏–Ω–µ
}
```

### –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç–∏

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –§–æ—Ä–º—É–ª–∞ |
|------|-----|----------|---------|
| `averageReceivables` | number | –°—Ä–µ–¥–Ω—è—è –¥–µ–±–∏—Ç–æ—Ä—Å–∫–∞—è –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ –ø–µ—Ä–∏–æ–¥ (—Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü) | `(–î–ó –Ω–∞ –Ω–∞—á–∞–ª–æ –º–µ—Å—è—Ü–∞ + –î–ó –Ω–∞ –∫–æ–Ω–µ—Ü –º–µ—Å—è—Ü–∞) / 2` |
| `turnoverRatio` | number | –û–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç—å –¥–µ–±–∏—Ç–æ—Ä—Å–∫–æ–π –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏ (—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –î–ó –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∞—Å—å –≤ –¥–µ–Ω—å–≥–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥) | `–≤—ã—Ä—É—á–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ / —Å—Ä–µ–¥–Ω—è—è –î–ó` |
| `periodRevenue` | number | –í—ã—Ä—É—á–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ (—Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü) - —Å—É–º–º–∞ –≤—Å–µ—Ö —Å—á–µ—Ç–æ–≤, —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ | `—Å—É–º–º–∞(totalAmount) –≥–¥–µ issueDate –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ` |

### –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –§–æ—Ä–º—É–ª–∞ |
|------|-----|----------|---------|
| `averagePaymentDays` | number | –°—Ä–µ–¥–Ω–∏–π —Å—Ä–æ–∫ –æ–ø–ª–∞—Ç—ã (–æ—Ç –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç–∞ –¥–æ –æ–ø–ª–∞—Ç—ã, –≤ –¥–Ω—è—Ö) | `—Å—Ä–µ–¥–Ω–µ–µ(paymentDate - issueDate)` –¥–ª—è –≤—Å–µ—Ö –ø–ª–∞—Ç–µ–∂–µ–π |
| `onTimePaymentsAmount` | number | –°—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω—ã –≤ —Å—Ä–æ–∫ (`paymentDate <= dueDate`) | `—Å—É–º–º–∞(amount) –≥–¥–µ isOnTime = true` |
| `overduePaymentsPercentage` | number | –ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π –æ—Ç –æ–±—â–µ–π —Å—É–º–º—ã –≤—Å–µ—Ö –ø–ª–∞—Ç–µ–∂–µ–π | `(—Å—É–º–º–∞ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π / –æ–±—â–∞—è —Å—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π) √ó 100` |

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### cURL

```bash
# –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω
TOKEN=$(curl -X POST http://localhost:3001/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@example.com","password":"password"}' \
  | jq -r '.token')

# –ó–∞–ø—Ä–æ—Å–∏—Ç–µ Dashboard
curl -X GET http://localhost:3001/api/v1/reports/dashboard/summary \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json"
```

### JavaScript (Fetch API)

```javascript
// –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω
const loginResponse = await fetch('http://localhost:3001/api/v1/auth/login', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    email: 'admin@example.com',
    password: 'password'
  })
});

const { token } = await loginResponse.json();

// –ó–∞–ø—Ä–æ—Å–∏—Ç–µ Dashboard
const dashboardResponse = await fetch(
  'http://localhost:3001/api/v1/reports/dashboard/summary',
  {
    method: 'GET',
    headers: {
      'Authorization': `Bearer ${token}`,
      'Content-Type': 'application/json'
    }
  }
);

const dashboardData = await dashboardResponse.json();
console.log(dashboardData);
```

### Postman

1. **–°–æ–∑–¥–∞–π—Ç–µ –∑–∞–ø—Ä–æ—Å**:
   - Method: `GET`
   - URL: `http://localhost:3001/api/v1/reports/dashboard/summary`

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é**:
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Authorization"
   - Type: `Bearer Token`
   - Token: –≤—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à JWT —Ç–æ–∫–µ–Ω

3. **–ò–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤—Ä—É—á–Ω—É—é**:
   - Key: `Authorization`
   - Value: `Bearer YOUR_TOKEN_HERE`

### Python (requests)

```python
import requests

# –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω
login_response = requests.post(
    'http://localhost:3001/api/v1/auth/login',
    json={
        'email': 'admin@example.com',
        'password': 'password'
    }
)
token = login_response.json()['token']

# –ó–∞–ø—Ä–æ—Å–∏—Ç–µ Dashboard
headers = {
    'Authorization': f'Bearer {token}',
    'Content-Type': 'application/json'
}

dashboard_response = requests.get(
    'http://localhost:3001/api/v1/reports/dashboard/summary',
    headers=headers
)

dashboard_data = dashboard_response.json()
print(dashboard_data)
```

---

## –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π

### –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –î–ó

- **`totalReceivables`**: –û–±—â–∞—è —Å—É–º–º–∞ –¥–µ–Ω–µ–≥, –∫–æ—Ç–æ—Ä—É—é –≤–∞–º –¥–æ–ª–∂–Ω—ã –∫–ª–∏–µ–Ω—Ç—ã
- **`overdueReceivables`**: –°–∫–æ–ª—å–∫–æ –∏–∑ —ç—Ç–æ–π —Å—É–º–º—ã –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–æ
- **`overduePercentage`**: –ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ—Å—Ä–æ—á–∫–∏ (—á–µ–º –≤—ã—à–µ, —Ç–µ–º —Ö—É–∂–µ)
  - `< 10%` - –æ—Ç–ª–∏—á–Ω–æ
  - `10-30%` - –Ω–æ—Ä–º–∞–ª—å–Ω–æ
  - `> 30%` - —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç–∞—Ä–µ–Ω–∏—è

- **`Current`**: –ö–ª–∏–µ–Ω—Ç—ã –ø–ª–∞—Ç—è—Ç –≤ —Å—Ä–æ–∫ ‚úÖ
- **`1-30`**: –ù–µ–±–æ–ª—å—à–∞—è –ø—Ä–æ—Å—Ä–æ—á–∫–∞, –Ω—É–∂–µ–Ω –ø—Ä–æ–∑–≤–æ–Ω
- **`31-60`**: –°—Ä–µ–¥–Ω—è—è –ø—Ä–æ—Å—Ä–æ—á–∫–∞, –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–µ—Ç–µ–Ω–∑–∏–∏
- **`61-90`**: –°—Ç–∞—Ä–∞—è –ø—Ä–æ—Å—Ä–æ—á–∫–∞, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å—É–¥—É
- **`91+`**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ—Å—Ä–æ—á–∫–∞, —Å—É–¥–µ–±–Ω–æ–µ –≤–∑—ã—Å–∫–∞–Ω–∏–µ

### –û–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç—å

- **`turnoverRatio`**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –î–ó –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∞—Å—å –≤ –¥–µ–Ω—å–≥–∏
  - `> 3` - –æ—Ç–ª–∏—á–Ω–æ (–∫–ª–∏–µ–Ω—Ç—ã –±—ã—Å—Ç—Ä–æ –ø–ª–∞—Ç—è—Ç)
  - `1-3` - –Ω–æ—Ä–º–∞–ª—å–Ω–æ
  - `< 1` - –ø–ª–æ—Ö–æ (–∫–ª–∏–µ–Ω—Ç—ã –º–µ–¥–ª–µ–Ω–Ω–æ –ø–ª–∞—Ç—è—Ç)

### –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π

- **`averagePaymentDays`**: –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç–∞ –¥–æ –æ–ø–ª–∞—Ç—ã
  - –ß–µ–º –º–µ–Ω—å—à–µ, —Ç–µ–º –ª—É—á—à–µ
- **`onTimePaymentsAmount`**: –°–∫–æ–ª—å–∫–æ –¥–µ–Ω–µ–≥ –ø–æ–ª—É—á–µ–Ω–æ –≤–æ–≤—Ä–µ–º—è
- **`overduePaymentsPercentage`**: –ü—Ä–æ—Ü–µ–Ω—Ç –ø–ª–∞—Ç–µ–∂–µ–π —Å –ø—Ä–æ—Å—Ä–æ—á–∫–æ–π
  - `< 10%` - –æ—Ç–ª–∏—á–Ω–æ
  - `10-25%` - –Ω–æ—Ä–º–∞–ª—å–Ω–æ
  - `> 25%` - —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è

---

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞—Å—á–µ—Ç–∞

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç

–í—Å–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è **–Ω–∞ –ª–µ—Ç—É** –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ:
- –¢–µ–∫—É—â–µ–π –¥–∞—Ç—ã
- –ê–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î
- –ò—Å—Ç–æ—Ä–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ù–ï –∫—ç—à–∏—Ä—É—é—Ç—Å—è** - –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

- –£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ —Å—á–µ—Ç–∞ (`status != 'PAID'`)
- –£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å—á–µ—Ç–∞ —Å –æ—Å—Ç–∞—Ç–∫–æ–º –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏ (`outstandingAmount > 0`)
- –ü—Ä–æ—Å—Ä–æ—á–∫–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ `dueDate < —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞`

### –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π

–ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ `averagePaymentDays`, `onTimePaymentsAmount`, `overduePaymentsPercentage` —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ `PaymentHistory`, –∫–æ—Ç–æ—Ä–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏:
- –°–æ–∑–¥–∞–Ω–∏–∏ —Å—á–µ—Ç–∞ —Å –æ–ø–ª–∞—Ç–æ–π
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –æ–ø–ª–∞—Ç—ã —Å—á–µ—Ç–∞

---

## –ü—Ä–∏–º–µ—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤

### –ü—É—Å—Ç–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–Ω–µ—Ç —Å—á–µ—Ç–æ–≤)

```json
{
  "totalReceivables": 0,
  "overdueReceivables": 0,
  "overduePercentage": 0,
  "currentReceivables": 0,
  "averagePaymentDelayDays": 0,
  "totalInvoicesCount": 0,
  "overdueInvoicesCount": 0,
  "agingStructure": [
    {"bucket": "Current", "amount": 0, "count": 0},
    {"bucket": "1-30", "amount": 0, "count": 0},
    {"bucket": "31-60", "amount": 0, "count": 0},
    {"bucket": "61-90", "amount": 0, "count": 0},
    {"bucket": "91+", "amount": 0, "count": 0}
  ],
  "averageReceivables": 0,
  "turnoverRatio": 0,
  "periodRevenue": 0,
  "averagePaymentDays": 0,
  "onTimePaymentsAmount": 0,
  "overduePaymentsPercentage": 0
}
```

### –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ `testdata/payment-history/01_single_on_time_payment.csv` –∏ `02_single_overdue_payment.csv`:

```json
{
  "totalReceivables": 0,
  "overdueReceivables": 0,
  "overduePercentage": 0,
  "currentReceivables": 0,
  "averagePaymentDelayDays": 0,
  "totalInvoicesCount": 0,
  "overdueInvoicesCount": 0,
  "agingStructure": [
    {"bucket": "Current", "amount": 0, "count": 0},
    {"bucket": "1-30", "amount": 0, "count": 0},
    {"bucket": "31-60", "amount": 0, "count": 0},
    {"bucket": "61-90", "amount": 0, "count": 0},
    {"bucket": "91+", "amount": 0, "count": 0}
  ],
  "averageReceivables": 0,
  "turnoverRatio": 0,
  "periodRevenue": 0,
  "averagePaymentDays": 12.5,
  "onTimePaymentsAmount": 10000,
  "overduePaymentsPercentage": 60.0
}
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ**:
- –û–±–∞ —Å—á–µ—Ç–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø–ª–∞—á–µ–Ω—ã, –ø–æ—ç—Ç–æ–º—É `totalReceivables = 0`
- –ù–æ –∏—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞—Å—å, –ø–æ—ç—Ç–æ–º—É:
  - `averagePaymentDays = 12.5` (—Å—Ä–µ–¥–Ω–µ–µ –º–µ–∂–¥—É 5 –∏ 20 –¥–Ω—è–º–∏)
  - `onTimePaymentsAmount = 10000` (–æ–¥–∏–Ω –ø–ª–∞—Ç–µ–∂ –≤ —Å—Ä–æ–∫)
  - `overduePaymentsPercentage = 60%` (15000 –∏–∑ 25000 –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–æ)

---

## –ö–æ–¥—ã –æ—à–∏–±–æ–∫

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏—á–∏–Ω–∞ |
|-----|----------|---------|
| `200` | –£—Å–ø–µ—à–Ω–æ | –ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ |
| `401` | –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω |
| `500` | –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ | –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –∏–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ –ë–î |

---

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –†–∞—Å—á–µ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Å—á–µ—Ç–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è MongoDB Aggregation Pipeline)

2. **–¢–æ—á–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö**: –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ –º–æ–º–µ–Ω—Ç –∑–∞–ø—Ä–æ—Å–∞. –î–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –ø–µ—Ä–∏–æ–¥–∞–º–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ

3. **–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π**: –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ `averagePaymentDays`, `onTimePaymentsAmount`, `overduePaymentsPercentage` –±—É–¥—É—Ç —Ä–∞–≤–Ω—ã 0, –µ—Å–ª–∏ –≤ —Å–∏—Å—Ç–µ–º–µ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –≤ `PaymentHistory`

4. **–ü–µ—Ä–∏–æ–¥ —Ä–∞—Å—á–µ—Ç–∞**: –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç–∏ (`averageReceivables`, `turnoverRatio`, `periodRevenue`) —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—á–µ—Ç–∞—Ö

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è **–ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—Å–µ—Ö –ø–æ–ª—è—Ö —Å—á–µ—Ç–æ–≤** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

**`GET /api/v1/reports/invoices`** - –°–ø–∏—Å–æ–∫ —Å—á–µ—Ç–æ–≤ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

üìñ **[–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API —Å—á–µ—Ç–æ–≤](./API_INVOICES_LIST.md)**

**–í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –ø–æ–ª—è —Å—á–µ—Ç–∞**:
- –í—Å–µ –±–∞–∑–æ–≤—ã–µ –ø–æ–ª—è: `id`, `invoiceNumber`, `customerId`, `issueDate`, `dueDate`
- –°—É–º–º—ã: `totalAmount`, `paidAmount`, `outstandingAmount`
- –î–∞—Ç—ã —É—Å–ª—É–≥: `serviceStartDate`, `serviceEndDate`, `actualPaymentDate`
- –°—Ç–∞—Ç—É—Å—ã: `status`, `debtWorkStatus`
- –ë–∏–∑–Ω–µ—Å-–¥–∞–Ω–Ω—ã–µ: `serviceType`, `manager`, `contractNumber`
- –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã: `notes`, `lastContactDate`, `contactResult`
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ: `createdAt`, `updatedAt`
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ: `customer.name`, `customer.unp`

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤**:

```bash
# –í—Å–µ —Å—á–µ—Ç–∞ –ø–æ –£–ù–ü 12345678 (—á–µ—Ä–µ–∑ customerId)
GET /api/v1/reports/invoices?customerId=<customer_id>

# –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ —Å—á–µ—Ç–∞ —Å bucket 31-60 –¥–Ω–µ–π
GET /api/v1/reports/invoices?minDaysOverdue=31&maxDaysOverdue=60

# –°—á–µ—Ç–∞ –≤ —Å—Ç–∞—Ç—É—Å–µ "–ü—Ä–µ—Ç–µ–Ω–∑–∏—è"
GET /api/v1/reports/invoices?debtWorkStatus=CLAIM
```

### –î—Ä—É–≥–∏–µ –æ—Ç—á–µ—Ç—ã

- `GET /api/v1/reports/top-debtors` - –¢–æ–ø –¥–æ–ª–∂–Ω–∏–∫–æ–≤
- `GET /api/v1/reports/abc-analysis` - ABC-–∞–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤
- `GET /api/v1/reports/risk-concentration` - –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ —Ä–∏—Å–∫–æ–≤
- `GET /api/v1/reports/contract-analysis` - –ê–Ω–∞–ª–∏–∑ –ø–æ –¥–æ–≥–æ–≤–æ—Ä–∞–º
- `GET /api/v1/reports/customers-overdue` - –ö–ª–∏–µ–Ω—Ç—ã —Å –ø—Ä–æ—Å—Ä–æ—á–∫–æ–π

---

## –í–µ—Ä—Å–∏—è API

**–í–µ—Ä—Å–∏—è**: `v1`  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 2025-11-14  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω

