# ðŸ“‹ Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð¸Ð· 1Ð¡:Ð‘ÑƒÑ…Ð³Ð°Ð»Ñ‚ÐµÑ€Ð¸Ñ

## ðŸŽ¯ ÐžÐ±Ð·Ð¾Ñ€ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ°

Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÑƒ CSV Ñ„Ð°Ð¹Ð»Ð¾Ð² Ñ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸ ÑÑ‡ÐµÑ‚Ð¾Ð² Ð¸Ð· 1Ð¡:Ð‘ÑƒÑ…Ð³Ð°Ð»Ñ‚ÐµÑ€Ð¸Ñ Ñ‡ÐµÑ€ÐµÐ· REST API ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚. Ð¤Ð°Ð¹Ð» Ð¿Ñ€Ð¾Ñ…Ð¾Ð´Ð¸Ñ‚ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸ÑŽ, Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³ Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ/Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ Ð² Ð±Ð°Ð·Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ….

---

## ðŸ”Œ **Ð‘Ð»Ð¾Ðº 1: HTTP API Ð­Ð½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚**

### **Ð­Ð½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚**
```
POST /api/v1/data-uploads/1c-invoices
```

### **ÐÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ**
- **Ð¢Ð¸Ð¿**: Bearer Token (JWT)
- **Middleware**: `authMiddleware`
- **Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ**: ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð±Ñ‹Ñ‚ÑŒ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸Ñ†Ð¸Ñ€Ð¾Ð²Ð°Ð½

### **ÐÐ²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ**
- **Middleware**: `roleMiddleware(['ADMIN', 'ANALYST'])`
- **Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ**: Ð Ð¾Ð»ÑŒ `ADMIN` Ð¸Ð»Ð¸ `ANALYST`

### **Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°**
- **Content-Type**: `multipart/form-data`
- **ÐŸÐ¾Ð»Ðµ Ñ„Ð¾Ñ€Ð¼Ñ‹**: `file` (Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ)
- **Ð¢Ð¸Ð¿ Ñ„Ð°Ð¹Ð»Ð°**: CSV (`.csv`)
- **ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ€**: 10 ÐœÐ‘

### **ÐžÑ‚Ð²ÐµÑ‚ Ð¿Ñ€Ð¸ ÑƒÑÐ¿ÐµÑ…Ðµ (200)**
```json
{
  "message": "Ð¤Ð°Ð¹Ð» 1C ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½.",
  "totalRows": 150,
  "processedRows": 148,
  "createdCustomers": 25,
  "createdInvoices": 120,
  "updatedInvoices": 28,
  "skippedRows": 2,
  "errors": [
    "Ð¡Ñ‚Ñ€Ð¾ÐºÐ° 45: ÐžÑ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚ Ð½Ð¾Ð¼ÐµÑ€ Ð°ÐºÑ‚Ð°",
    "Ð¡Ñ‚Ñ€Ð¾ÐºÐ° 89: ÐÐµÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð°Ñ Ð´Ð°Ñ‚Ð° Ð½Ð°Ñ‡Ð°Ð»Ð° ÑƒÑÐ»ÑƒÐ³Ð¸"
  ]
}
```

---

## ðŸ“ **Ð‘Ð»Ð¾Ðº 2: Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚ CSV Ñ„Ð°Ð¹Ð»Ð°**

### **ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¸ (Ð½Ð° Ñ€ÑƒÑÑÐºÐ¾Ð¼ ÑÐ·Ñ‹ÐºÐµ)**
| Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ | Ð¢Ð¸Ð¿ Ð´Ð°Ð½Ð½Ñ‹Ñ… | ÐŸÑ€Ð¸Ð¼ÐµÑ€ |
|-----------|----------|------------|--------|
| `Ð”Ð°Ñ‚Ð°_Ð½Ð°Ñ‡Ð°Ð»Ð°_ÑƒÑÐ»ÑƒÐ³Ð¸` | Ð”Ð°Ñ‚Ð° Ð½Ð°Ñ‡Ð°Ð»Ð° Ð¾ÐºÐ°Ð·Ð°Ð½Ð¸Ñ ÑƒÑÐ»ÑƒÐ³Ð¸ | Ð”Ð°Ñ‚Ð° | `01.01.2024` |
| `Ð”Ð°Ñ‚Ð°_Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ñ_ÑƒÑÐ»ÑƒÐ³Ð¸` | Ð”Ð°Ñ‚Ð° Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ñ ÑƒÑÐ»ÑƒÐ³Ð¸ | Ð”Ð°Ñ‚Ð° | `31.01.2024` |
| `ÐÐ¾Ð¼ÐµÑ€_Ð°ÐºÑ‚Ð°` | ÐÐ¾Ð¼ÐµÑ€ Ð°ÐºÑ‚Ð° (Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ ÐºÐ°Ðº invoiceNumber) | Ð¡Ñ‚Ñ€Ð¾ÐºÐ° | `ÐÐšÐ¢-2024-001` |
| `ÐšÐ¾Ð½Ñ‚Ñ€Ð°Ð³ÐµÐ½Ñ‚` | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½Ñ‚Ñ€Ð°Ð³ÐµÐ½Ñ‚Ð° (ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°) | Ð¡Ñ‚Ñ€Ð¾ÐºÐ° | `ÐžÐžÐž "Ð Ð¾Ð³Ð° Ð¸ ÐšÐ¾Ð¿Ñ‹Ñ‚Ð°"` |
| `Ð˜ÐÐ` | Ð£ÐÐŸ ÐºÐ¾Ð½Ñ‚Ñ€Ð°Ð³ÐµÐ½Ñ‚Ð° (ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€) | Ð¡Ñ‚Ñ€Ð¾ÐºÐ° | `123456789` |
| `Ð¡ÑƒÐ¼Ð¼Ð°_Ðº_Ð¾Ð¿Ð»Ð°Ñ‚Ðµ` | ÐžÐ±Ñ‰Ð°Ñ ÑÑƒÐ¼Ð¼Ð° ÑÑ‡ÐµÑ‚Ð° | Ð§Ð¸ÑÐ»Ð¾ | `1500.50` |
| `Ð”Ð°Ñ‚Ð°_Ð¿Ð»Ð°Ð½Ð¸Ñ€ÑƒÐµÐ¼Ð¾Ð¹_Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹` | ÐŸÐ»Ð°Ð½Ð¸Ñ€ÑƒÐµÐ¼Ð°Ñ Ð´Ð°Ñ‚Ð° Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹ (dueDate) | Ð”Ð°Ñ‚Ð° | `15.02.2024` |

### **ÐžÐ¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¸**
| Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ | Ð¢Ð¸Ð¿ Ð´Ð°Ð½Ð½Ñ‹Ñ… | Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ |
|-----------|----------|------------|----------------------|
| `Ð”Ð¾Ð³Ð¾Ð²Ð¾Ñ€` | ÐÐ¾Ð¼ÐµÑ€ Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð° | Ð¡Ñ‚Ñ€Ð¾ÐºÐ° | - |
| `Ð¢Ð¸Ð¿_ÑƒÑÐ»ÑƒÐ³Ð¸` | Ð¢Ð¸Ð¿ ÑƒÑÐ»ÑƒÐ³Ð¸ | Ð¡Ñ‚Ñ€Ð¾ÐºÐ° | `OTHER` |
| `Ð¡Ñ€Ð¾Ðº_Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹_Ð´Ð½ÐµÐ¹` | Ð¡Ñ€Ð¾Ðº Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹ Ð² Ð´Ð½ÑÑ… | Ð§Ð¸ÑÐ»Ð¾ | `30` |
| `Ð¡ÑƒÐ¼Ð¼Ð°_Ð¾Ð¿Ð»Ð°Ñ‡ÐµÐ½Ð¾` | ÐžÐ¿Ð»Ð°Ñ‡ÐµÐ½Ð½Ð°Ñ ÑÑƒÐ¼Ð¼Ð° | Ð§Ð¸ÑÐ»Ð¾ | `0` |
| `Ð”Ð°Ñ‚Ð°_Ñ„Ð°ÐºÑ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹_Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹` | Ð”Ð°Ñ‚Ð° Ñ„Ð°ÐºÑ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹ | Ð”Ð°Ñ‚Ð° | - |
| `ÐžÑÑ‚Ð°Ñ‚Ð¾Ðº_Ð·Ð°Ð´Ð¾Ð»Ð¶ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸` | ÐžÑÑ‚Ð°Ñ‚Ð¾Ðº Ð´Ð¾Ð»Ð³Ð° | Ð§Ð¸ÑÐ»Ð¾ | - |
| `ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€` | ÐžÑ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€ | Ð¡Ñ‚Ñ€Ð¾ÐºÐ° | - |
| `ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ` | ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ñ/ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¸ | Ð¡Ñ‚Ñ€Ð¾ÐºÐ° | - |

### **ÐŸÑ€Ð¸Ð¼ÐµÑ€ CSV Ñ„Ð°Ð¹Ð»Ð°**
```csv
Ð”Ð°Ñ‚Ð°_Ð½Ð°Ñ‡Ð°Ð»Ð°_ÑƒÑÐ»ÑƒÐ³Ð¸,Ð”Ð°Ñ‚Ð°_Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ñ_ÑƒÑÐ»ÑƒÐ³Ð¸,ÐÐ¾Ð¼ÐµÑ€_Ð°ÐºÑ‚Ð°,ÐšÐ¾Ð½Ñ‚Ñ€Ð°Ð³ÐµÐ½Ñ‚,Ð˜ÐÐ,Ð¡ÑƒÐ¼Ð¼Ð°_Ðº_Ð¾Ð¿Ð»Ð°Ñ‚Ðµ,Ð”Ð°Ñ‚Ð°_Ð¿Ð»Ð°Ð½Ð¸Ñ€ÑƒÐµÐ¼Ð¾Ð¹_Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹,Ð¡ÑƒÐ¼Ð¼Ð°_Ð¾Ð¿Ð»Ð°Ñ‡ÐµÐ½Ð¾,Ð¢Ð¸Ð¿_ÑƒÑÐ»ÑƒÐ³Ð¸
01.01.2024,31.01.2024,ÐÐšÐ¢-2024-001,ÐžÐžÐž "Ð Ð¾Ð³Ð° Ð¸ ÐšÐ¾Ð¿Ñ‹Ñ‚Ð°",123456789,1500.50,15.02.2024,0,Ð¡Ð¾Ð¿Ñ€Ð¾Ð²Ð¾Ð¶Ð´ÐµÐ½Ð¸Ðµ ÐŸÐšÐ¢
01.02.2024,29.02.2024,ÐÐšÐ¢-2024-002,Ð˜ÐŸ Ð˜Ð²Ð°Ð½Ð¾Ð² Ð˜.Ð˜.,987654321,2500.00,15.03.2024,1000.00,Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° ÐšÐšÐ¢
```

---

## ðŸ”„ **Ð‘Ð»Ð¾Ðº 3: ÐŸÐ¾Ñ‚Ð¾Ðº Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°**

### **3.1. ÐŸÑ€Ð¸ÐµÐ¼ Ñ„Ð°Ð¹Ð»Ð° (Middleware)**
**Ð¤Ð°Ð¹Ð»**: `src/infrastructure/web/express/middlewares/upload.middleware.ts`

1. **ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ‚Ð¸Ð¿Ð° Ñ„Ð°Ð¹Ð»Ð°**
   - MIME type: `text/csv`
   - Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ðµ: `.csv`
   - ÐŸÑ€Ð¸ Ð½ÐµÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ð¸ â†’ Ð¾ÑˆÐ¸Ð±ÐºÐ° 400

2. **Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ñ„Ð°Ð¹Ð»Ð°**
   - Ð”Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ñ: `uploads/` (ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸)
   - Ð˜Ð¼Ñ Ñ„Ð°Ð¹Ð»Ð°: `file-{timestamp}-{random}.csv`
   - Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚: `file-1704067200000-123456789.csv`

3. **ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ**
   - ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ€: 10 ÐœÐ‘
   - ÐŸÑ€Ð¸ Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐµÐ½Ð¸Ð¸ â†’ Ð¾ÑˆÐ¸Ð±ÐºÐ° 400

### **3.2. ÐšÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€**
**Ð¤Ð°Ð¹Ð»**: `src/infrastructure/web/express/controllers/data-upload.controller.ts`
**ÐœÐµÑ‚Ð¾Ð´**: `upload1cInvoices()`

1. **Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°**
   - ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ Ñ„Ð°Ð¹Ð»Ð° (`req.file`)
   - ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ `userId` Ð¸Ð· `req.user` (ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½ `authMiddleware`)
   - ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ Ð¿ÑƒÑ‚Ð¸ Ðº Ñ„Ð°Ð¹Ð»Ñƒ (`req.file.path`)

2. **Ð’Ñ‹Ð·Ð¾Ð² Use Case**
   - ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ ÑÐºÐ·ÐµÐ¼Ð¿Ð»ÑÑ€Ð° `Process1cInvoiceUploadUseCase` Ð¸Ð· DI ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð°
   - ÐŸÐµÑ€ÐµÐ´Ð°Ñ‡Ð° `filePath` Ð¸ `userId`
   - ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð° Ð¸Ð»Ð¸ Ð¾ÑˆÐ¸Ð±Ð¾Ðº

### **3.3. Use Case - ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð»Ð¾Ð³Ð¸ÐºÐ°**
**Ð¤Ð°Ð¹Ð»**: `src/application/use-cases/data-uploads/process-1c-invoice-upload.use-case.ts`
**ÐšÐ»Ð°ÑÑ**: `Process1cInvoiceUploadUseCase`

#### **Ð­Ñ‚Ð°Ð¿ 1: Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ**
```typescript
- Ð¡Ð±Ñ€Ð¾Ñ ÑÑ‡ÐµÑ‚Ñ‡Ð¸ÐºÐ¾Ð² (createdCustomersCount, createdInvoicesCount, etc.)
- Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ userId Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð²
```

#### **Ð­Ñ‚Ð°Ð¿ 2: Ð§Ñ‚ÐµÐ½Ð¸Ðµ Ð¸ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³ CSV**
```typescript
1. Ð§Ñ‚ÐµÐ½Ð¸Ðµ Ñ„Ð°Ð¹Ð»Ð°: fs.readFileSync(filePath, 'utf-8')
2. ÐŸÐ°Ñ€ÑÐ¸Ð½Ð³ CSV: Papa.parse() Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°Ð¼Ð¸:
   - header: true (Ð¿ÐµÑ€Ð²Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ° = Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¸)
   - skipEmptyLines: true
   - dynamicTyping: false (Ð²ÑÐµ ÐºÐ°Ðº ÑÑ‚Ñ€Ð¾ÐºÐ¸)
3. Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð²:
   - ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ Ð²ÑÐµÑ… Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð²
   - ÐŸÑ€Ð¸ Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ð¸ â†’ Ð¾ÑˆÐ¸Ð±ÐºÐ° Ñ Ð¿ÐµÑ€ÐµÑ‡Ð¸ÑÐ»ÐµÐ½Ð¸ÐµÐ¼ Ð½ÐµÐ´Ð¾ÑÑ‚Ð°ÑŽÑ‰Ð¸Ñ…
4. Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¿ÑƒÑÑ‚Ñ‹Ñ… ÑÑ‚Ñ€Ð¾Ðº
```

#### **Ð­Ñ‚Ð°Ð¿ 3: ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° ÑÑ‚Ñ€Ð¾Ðº**
```typescript
Ð”Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐ¸ CSV:
  1. Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð¸ Ñ‚Ñ€Ð°Ð½ÑÑ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… (validateAndTransformRow)
  2. ÐŸÐ¾Ð¸ÑÐº/ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð° (findOrCreateCustomer)
  3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¾Ð²Ð°Ð½Ð¸Ñ ÑÑ‡ÐµÑ‚Ð° (findByInvoiceNumberAndCustomerId)
  4. Ð•ÑÐ»Ð¸ ÑÑ‡ÐµÑ‚ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚:
     - ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹ (ÐµÑÐ»Ð¸ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ð»Ð°ÑÑŒ paidAmount)
     - Ð˜Ð½Ð°Ñ‡Ðµ Ð¿Ñ€Ð¾Ð¿ÑƒÑÐº ÑÑ‚Ñ€Ð¾ÐºÐ¸
  5. Ð•ÑÐ»Ð¸ ÑÑ‡ÐµÑ‚ Ð½Ð¾Ð²Ñ‹Ð¹:
     - Ð Ð°ÑÑ‡ÐµÑ‚ ÑÑ‚Ð°Ñ‚ÑƒÑÐ° Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ð´Ð¾Ð»Ð³Ð¾Ð¼ (calculateDebtWorkStatus)
     - Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð½Ð¾Ð²Ð¾Ð³Ð¾ ÑÑ‡ÐµÑ‚Ð° (invoiceRepository.create)
```

#### **Ð­Ñ‚Ð°Ð¿ 4: Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ðµ**
```typescript
1. Ð¤Ð¾Ñ€Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð° (getFinalResult)
2. Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð³Ð¾ Ñ„Ð°Ð¹Ð»Ð° (tryDeleteFile)
3. Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‚ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ¸ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸
```

---

## âœ… **Ð‘Ð»Ð¾Ðº 4: Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð¸ Ñ‚Ñ€Ð°Ð½ÑÑ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…**

### **4.1. Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ ÑÑ‚Ñ€Ð¾ÐºÐ¸**
**ÐœÐµÑ‚Ð¾Ð´**: `validateAndTransformRow()`

#### **ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ð¾Ð»Ñ**
- `ÐÐ¾Ð¼ÐµÑ€_Ð°ÐºÑ‚Ð°` â†’ `invoiceNumber`
- `ÐšÐ¾Ð½Ñ‚Ñ€Ð°Ð³ÐµÐ½Ñ‚` â†’ `customerName`
- `Ð˜ÐÐ` â†’ `unp`
- `Ð”Ð°Ñ‚Ð°_Ð½Ð°Ñ‡Ð°Ð»Ð°_ÑƒÑÐ»ÑƒÐ³Ð¸` â†’ `serviceStartDate`
- `Ð”Ð°Ñ‚Ð°_Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ñ_ÑƒÑÐ»ÑƒÐ³Ð¸` â†’ `serviceEndDate`
- `Ð”Ð°Ñ‚Ð°_Ð¿Ð»Ð°Ð½Ð¸Ñ€ÑƒÐµÐ¼Ð¾Ð¹_Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹` â†’ `dueDate`
- `Ð¡ÑƒÐ¼Ð¼Ð°_Ðº_Ð¾Ð¿Ð»Ð°Ñ‚Ðµ` â†’ `totalAmount`

#### **ÐŸÐ°Ñ€ÑÐ¸Ð½Ð³ ÑÑƒÐ¼Ð¼**
```typescript
- Ð—Ð°Ð¼ÐµÐ½Ð° Ð·Ð°Ð¿ÑÑ‚Ð¾Ð¹ Ð½Ð° Ñ‚Ð¾Ñ‡ÐºÑƒ: "1500,50" â†’ 1500.50
- Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ: totalAmount > 0, paidAmount >= 0
- ÐŸÑ€Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐµ â†’ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð² Ð¼Ð°ÑÑÐ¸Ð² errors
```

#### **ÐŸÐ°Ñ€ÑÐ¸Ð½Ð³ Ð´Ð°Ñ‚**
**ÐœÐµÑ‚Ð¾Ð´**: `parseDate()`

ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÐ¼Ñ‹Ðµ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ñ‹:
1. ISO 8601: `2024-01-15T00:00:00Z`
2. `yyyy-MM-dd`: `2024-01-15`
3. `dd.MM.yyyy`: `15.01.2024`
4. `MM/dd/yyyy`: `01/15/2024`

**ÐÐ¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð´Ð°Ñ‚ Ð´Ð»Ñ Ð´ÐµÐ¼Ð¾-Ð´Ð°Ð½Ð½Ñ‹Ñ…**:
- Ð•ÑÐ»Ð¸ Ð´Ð°Ñ‚Ð° ÑÑ‚Ð°Ñ€ÑˆÐµ 200 Ð´Ð½ÐµÐ¹ â†’ Ð¿ÐµÑ€ÐµÐ½Ð¾Ñ Ð½Ð° Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð³Ð¾Ð´
- Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð¼ÐµÑÑÑ†Ð° Ð¸ Ð´Ð½Ñ Ð´Ð»Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾Ð¹ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ð½Ð¾Ð¹ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹

#### **ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ ÑÑ‚Ð°Ñ‚ÑƒÑÐ° ÑÑ‡ÐµÑ‚Ð°**
```typescript
if (paidAmount >= totalAmount) {
  status = 'PAID'
} else if (dueDate < currentDate) {
  status = 'OVERDUE'
} else {
  status = 'OPEN'
}
```

#### **ÐœÐ°Ð¿Ð¿Ð¸Ð½Ð³ Ñ‚Ð¸Ð¿Ð° ÑƒÑÐ»ÑƒÐ³Ð¸**
**ÐšÐ»Ð°ÑÑ**: `ServiceTypeMapper`
**ÐœÐµÑ‚Ð¾Ð´**: `map()`

| Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¸Ð· CSV | ServiceType enum |
|----------------|------------------|
| `Ð¡Ð¾Ð¿Ñ€Ð¾Ð²Ð¾Ð¶Ð´ÐµÐ½Ð¸Ðµ ÐŸÐšÐ¢` | `PKT_SUPPORT` |
| `Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° ÐšÐšÐ¢` | `KKT_INSTALLATION` |
| `ÐžÐ±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ ÐšÐšÐ¢` | `KKT_SERVICE` |
| `ÐžÐ±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ Ñ‚Ð¾Ñ€Ð³. Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¾Ð²` | `VENDING_SERVICE` |
| `Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ñ‚Ð¾Ñ€Ð³. Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð°` | `VENDING_INSTALLATION` |
| ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ð¹ Ñ‚Ð¸Ð¿ | `OTHER` |

**ÐžÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸**:
- ÐÐµÑ‡ÑƒÐ²ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ðº Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ñƒ
- Ð¢Ñ€Ð¸Ð¼Ð¼Ð¸Ð½Ð³ Ð¿Ñ€Ð¾Ð±ÐµÐ»Ð¾Ð²
- Fallback Ð½Ð° `OTHER` Ð¿Ñ€Ð¸ Ð½ÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾Ð¼ Ñ‚Ð¸Ð¿Ðµ

### **4.2. Ð’Ñ‹Ñ‡Ð¸ÑÐ»ÑÐµÐ¼Ñ‹Ðµ Ð¿Ð¾Ð»Ñ**

#### **Ð”Ð°Ñ‚Ð° Ð²Ñ‹ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ñ ÑÑ‡ÐµÑ‚Ð° (issueDate)**
```typescript
issueDate = serviceEndDate
// Ð”Ð°Ñ‚Ð° Ð²Ñ‹ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ñ = Ð´Ð°Ñ‚Ð° Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ñ ÑƒÑÐ»ÑƒÐ³Ð¸
```

#### **Ð¡Ñ€Ð¾Ðº Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹ (paymentTermDays)**
```typescript
paymentTermDays = parseInt(Ð¡Ñ€Ð¾Ðº_Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹_Ð´Ð½ÐµÐ¹ || '30', 10)
// ÐŸÐ¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ: 30 Ð´Ð½ÐµÐ¹
```

---

## ðŸ‘¥ **Ð‘Ð»Ð¾Ðº 5: Ð Ð°Ð±Ð¾Ñ‚Ð° Ñ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°Ð¼Ð¸**

### **5.1. ÐŸÐ¾Ð¸ÑÐº/ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°**
**ÐœÐµÑ‚Ð¾Ð´**: `findOrCreateCustomer()`

#### **ÐÐ»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼**
1. **ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ Ð£ÐÐŸ**
   ```typescript
   customer = await customerRepository.findByUnp(unp)
   ```

2. **Ð•ÑÐ»Ð¸ ÐºÐ»Ð¸ÐµÐ½Ñ‚ Ð½Ð°Ð¹Ð´ÐµÐ½**
   - ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ñ Ð¸Ð¼ÐµÐ½Ð¸
   - ÐŸÑ€Ð¸ Ñ€Ð°ÑÑ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ð¸ â†’ Ð¿Ñ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ðµ Ð² Ð»Ð¾Ð³
   - Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‚ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ³Ð¾ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°

3. **Ð•ÑÐ»Ð¸ ÐºÐ»Ð¸ÐµÐ½Ñ‚ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½**
   ```typescript
   newCustomer = await customerRepository.create({
     name: customerName,
     unp: unp,
     userId: currentUserId
   })
   ```
   - Ð£Ð²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ðµ ÑÑ‡ÐµÑ‚Ñ‡Ð¸ÐºÐ° `createdCustomersCount`
   - Ð›Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ

4. **ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¾ÑˆÐ¸Ð±Ð¾Ðº**
   - ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð½Ð°Ñ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ° Ð¿Ð¾Ð¸ÑÐºÐ°
   - ÐŸÑ€Ð¸ Ð½ÐµÑƒÐ´Ð°Ñ‡Ðµ â†’ Ð¾ÑˆÐ¸Ð±ÐºÐ° Ñ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸ÐµÐ¼

### **5.2. Ð¡Ð²ÑÐ·ÑŒ Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼**
- ÐšÐ°Ð¶Ð´Ñ‹Ð¹ ÐºÐ»Ð¸ÐµÐ½Ñ‚ Ð¿Ñ€Ð¸Ð²ÑÐ·Ð°Ð½ Ðº `userId` Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ð²ÑˆÐµÐ³Ð¾ Ñ„Ð°Ð¹Ð»
- Ð­Ñ‚Ð¾ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡Ð¸Ð²Ð°ÐµÑ‚ Ð¸Ð·Ð¾Ð»ÑÑ†Ð¸ÑŽ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¼ÐµÐ¶Ð´Ñƒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑÐ¼Ð¸

---

## ðŸ“„ **Ð‘Ð»Ð¾Ðº 6: Ð Ð°Ð±Ð¾Ñ‚Ð° ÑÐ¾ ÑÑ‡ÐµÑ‚Ð°Ð¼Ð¸**

### **6.1. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð¾Ð²**
**ÐœÐµÑ‚Ð¾Ð´**: `findByInvoiceNumberAndCustomerId()`

```typescript
existingInvoice = await invoiceRepository.findByInvoiceNumberAndCustomerId(
  invoiceNumber,
  customerId
)
```

**ÐšÑ€Ð¸Ñ‚ÐµÑ€Ð¸Ð¹ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸**: ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð°Ñ†Ð¸Ñ `invoiceNumber` + `customerId`

### **6.2. ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ³Ð¾ ÑÑ‡ÐµÑ‚Ð°**
**Ð£ÑÐ»Ð¾Ð²Ð¸Ðµ**: ÑÑ‡ÐµÑ‚ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚ Ð¸ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ð»Ð°ÑÑŒ `paidAmount`

```typescript
if (existingInvoice.paidAmount !== validatedData.paidAmount) {
  await invoiceRepository.updatePayment(
    existingInvoice.id,
    validatedData.paidAmount,
    validatedData.actualPaymentDate
  )
  updatedInvoicesCount++
}
```

**Ð§Ñ‚Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÑ‚ÑÑ**:
- `paidAmount`
- `actualPaymentDate` (ÐµÑÐ»Ð¸ ÑƒÐºÐ°Ð·Ð°Ð½Ð°)
- ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿ÐµÑ€ÐµÑÑ‡ÐµÑ‚ `status` Ð¸ `debtWorkStatus`

### **6.3. Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð½Ð¾Ð²Ð¾Ð³Ð¾ ÑÑ‡ÐµÑ‚Ð°**

#### **Ð Ð°ÑÑ‡ÐµÑ‚ ÑÑ‚Ð°Ñ‚ÑƒÑÐ° Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ð´Ð¾Ð»Ð³Ð¾Ð¼**
**ÐœÐµÑ‚Ð¾Ð´**: `calculateDebtWorkStatus()`

| ÐŸÑ€Ð¾ÑÑ€Ð¾Ñ‡ÐºÐ° (Ð´Ð½Ð¸) | DebtWorkStatus | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|----------------|----------------|-----------|
| 0 | `IN_TIME` | Ð’ ÑÑ€Ð¾Ðº |
| 1-30 | `CALL` | ÐŸÑ€Ð¾Ð·Ð²Ð¾Ð½ |
| 31-60 | `CLAIM` | ÐŸÑ€ÐµÑ‚ÐµÐ½Ð·Ð¸Ñ |
| 61-90 | `PRE_TRIAL` | ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ðº ÑÑƒÐ´Ñƒ |
| 91-180 | `TRIAL` | Ð¡ÑƒÐ´ |
| 180+ | `COLLECTION` | Ð’Ð·Ñ‹ÑÐºÐ°Ð½Ð¸Ðµ |
| ÐžÐ¿Ð»Ð°Ñ‡ÐµÐ½ | `CLOSED` | Ð—Ð°ÐºÑ€Ñ‹Ñ‚ |

#### **Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð·Ð°Ð¿Ð¸ÑÐ¸**
```typescript
await invoiceRepository.create({
  invoiceNumber,
  customerId,
  issueDate,
  dueDate,
  serviceStartDate,
  serviceEndDate,
  totalAmount,
  paidAmount,
  paymentTermDays,
  actualPaymentDate,
  status,
  debtWorkStatus,
  serviceType,
  manager,
  notes
})
```

---

## ðŸ—„ï¸ **Ð‘Ð»Ð¾Ðº 7: Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð² Ð‘Ð”**

### **7.1. Ð¡ÑƒÑ‰Ð½Ð¾ÑÑ‚ÑŒ Customer**
```typescript
{
  id: string (ObjectId)
  name: string
  unp: string (ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð² Ñ€Ð°Ð¼ÐºÐ°Ñ… userId)
  contactInfo?: string
  userId: string (ÑÐ²ÑÐ·ÑŒ Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼)
  createdAt: Date
  updatedAt: Date
}
```

### **7.2. Ð¡ÑƒÑ‰Ð½Ð¾ÑÑ‚ÑŒ Invoice**
```typescript
{
  id: string (ObjectId)
  invoiceNumber: string
  customerId: string (ObjectId â†’ Customer)
  
  // Ð”Ð°Ñ‚Ñ‹
  issueDate: Date
  dueDate: Date
  serviceStartDate?: Date
  serviceEndDate?: Date
  actualPaymentDate?: Date
  
  // Ð¡ÑƒÐ¼Ð¼Ñ‹
  totalAmount: number
  paidAmount: number
  paymentTermDays: number
  
  // Ð¡Ñ‚Ð°Ñ‚ÑƒÑÑ‹
  status: 'OPEN' | 'PAID' | 'OVERDUE'
  debtWorkStatus?: 'IN_TIME' | 'CALL' | 'CLAIM' | ...
  
  // Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾
  serviceType?: 'PKT_SUPPORT' | 'KKT_INSTALLATION' | ...
  manager?: string
  notes?: string
  
  createdAt: Date
  updatedAt: Date
}
```

---

## âš ï¸ **Ð‘Ð»Ð¾Ðº 8: ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¾ÑˆÐ¸Ð±Ð¾Ðº**

### **8.1. ÐžÑˆÐ¸Ð±ÐºÐ¸ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ð° CSV**
- **ÐžÑ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ðµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð²** â†’ Ð¾ÑˆÐ¸Ð±ÐºÐ° 400 Ñ Ð¿ÐµÑ€ÐµÑ‡Ð¸ÑÐ»ÐµÐ½Ð¸ÐµÐ¼
- **ÐžÑˆÐ¸Ð±ÐºÐ¸ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ð° ÑÑ‚Ñ€Ð¾Ðº** â†’ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð² Ð¼Ð°ÑÑÐ¸Ð² `errors` Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð°

### **8.2. ÐžÑˆÐ¸Ð±ÐºÐ¸ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¸ ÑÑ‚Ñ€Ð¾Ðº**
- **ÐÐµÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ** â†’ ÑÑ‚Ñ€Ð¾ÐºÐ° Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ, Ð¾ÑˆÐ¸Ð±ÐºÐ° Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ÑÑ Ð² `errors`
- **Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚**: `"Ð¡Ñ‚Ñ€Ð¾ÐºÐ° {Ð½Ð¾Ð¼ÐµÑ€}: {Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸}"`

### **8.3. ÐžÑˆÐ¸Ð±ÐºÐ¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°**
- **ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ñ Ð‘Ð”** â†’ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð°Ñ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ° Ð¿Ð¾Ð¸ÑÐºÐ°
- **ÐŸÑ€Ð¸ Ð½ÐµÑƒÐ´Ð°Ñ‡Ðµ** â†’ ÑÑ‚Ñ€Ð¾ÐºÐ° Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ, Ð¾ÑˆÐ¸Ð±ÐºÐ° Ð² `errors`

### **8.4. ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸**
- **ÐžÑˆÐ¸Ð±ÐºÐ° Ñ‡Ñ‚ÐµÐ½Ð¸Ñ Ñ„Ð°Ð¹Ð»Ð°** â†’ Ð¾ÑˆÐ¸Ð±ÐºÐ° 500
- **ÐžÑˆÐ¸Ð±ÐºÐ° Use Case** â†’ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ð° Ð² Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ñ‹Ð¹ error handler

### **8.5. Ð“Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ð¸**
- **Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð³Ð¾ Ñ„Ð°Ð¹Ð»Ð°**: Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ÑÑ Ð² Ð±Ð»Ð¾ÐºÐµ `finally`
- **Ð§Ð°ÑÑ‚Ð¸Ñ‡Ð½Ð°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ°**: Ð´Ð°Ð¶Ðµ Ð¿Ñ€Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐ°Ñ… Ð² Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ñ… ÑÑ‚Ñ€Ð¾ÐºÐ°Ñ…, Ð¾ÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ

---

## ðŸ“Š **Ð‘Ð»Ð¾Ðº 9: Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸**

### **ÐœÐµÑ‚Ñ€Ð¸ÐºÐ¸ Ð² Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ðµ**
```typescript
{
  totalRows: number        // Ð’ÑÐµÐ³Ð¾ ÑÑ‚Ñ€Ð¾Ðº Ð² CSV
  processedRows: number    // Ð£ÑÐ¿ÐµÑˆÐ½Ð¾ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ð½Ñ‹Ñ… ÑÑ‚Ñ€Ð¾Ðº
  createdCustomers: number // Ð¡Ð¾Ð·Ð´Ð°Ð½Ð½Ñ‹Ñ… ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð²
  createdInvoices: number  // Ð¡Ð¾Ð·Ð´Ð°Ð½Ð½Ñ‹Ñ… ÑÑ‡ÐµÑ‚Ð¾Ð²
  updatedInvoices: number  // ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ñ… ÑÑ‡ÐµÑ‚Ð¾Ð²
  skippedRows: number      // ÐŸÑ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð½Ñ‹Ñ… ÑÑ‚Ñ€Ð¾Ðº (Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ñ‹ + Ð¾ÑˆÐ¸Ð±ÐºÐ¸)
  errors: string[]         // ÐœÐ°ÑÑÐ¸Ð² Ð¾ÑˆÐ¸Ð±Ð¾Ðº Ñ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸ÑÐ¼Ð¸
}
```

### **Ð›Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ**
- Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð²: `console.log()`
- ÐŸÑ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ñ: `console.warn()` (Ñ€Ð°ÑÑ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ðµ Ð¸Ð¼ÐµÐ½ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð², Ð½ÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ðµ Ñ‚Ð¸Ð¿Ñ‹ ÑƒÑÐ»ÑƒÐ³)
- ÐžÑˆÐ¸Ð±ÐºÐ¸: `console.error()` (Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ ÑÑ‚Ñ€Ð¾Ðº, ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ñ„Ð°Ð¹Ð»Ð¾Ð²)

---

## ðŸ”§ **Ð‘Ð»Ð¾Ðº 10: Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð´ÐµÑ‚Ð°Ð»Ð¸ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸**

### **10.1. Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸**
- **PapaParse** (`papaparse`): Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³ CSV Ñ„Ð°Ð¹Ð»Ð¾Ð²
- **Multer**: Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° multipart/form-data
- **date-fns**: Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³ Ð¸ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð´Ð°Ñ‚ (`parse`, `parseISO`, `isValid`)
- **tsyringe**: Dependency Injection ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€

### **10.2. ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°**
- **Clean Architecture**: Ñ€Ð°Ð·Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð½Ð° Domain, Application, Infrastructure
- **Use Case Pattern**: Ð±Ð¸Ð·Ð½ÐµÑ-Ð»Ð¾Ð³Ð¸ÐºÐ° Ð² `Process1cInvoiceUploadUseCase`
- **Repository Pattern**: Ð°Ð±ÑÑ‚Ñ€Ð°ÐºÑ†Ð¸Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº Ð´Ð°Ð½Ð½Ñ‹Ð¼

### **10.3. Ð¤Ð°Ð¹Ð»Ð¾Ð²Ð°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð°**
- **Ð’Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ðµ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ**: `uploads/` Ð² ÐºÐ¾Ñ€Ð½Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
- **ÐÐ²Ñ‚Ð¾ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ**: Ñ„Ð°Ð¹Ð»Ñ‹ ÑƒÐ´Ð°Ð»ÑÑŽÑ‚ÑÑ Ð¿Ð¾ÑÐ»Ðµ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸
- **Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ**: ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¸Ð¼ÐµÐ½Ð° Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð¿Ñ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰Ð°ÑŽÑ‚ ÐºÐ¾Ð»Ð»Ð¸Ð·Ð¸Ð¸

### **10.4. ÐŸÑ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ**
- **ÐŸÐ¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ°**: ÑÑ‚Ñ€Ð¾ÐºÐ¸ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ Ð¿Ð¾ Ð¾Ð´Ð½Ð¾Ð¹
- **Ð¢Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸**: ÐºÐ°Ð¶Ð´Ð°Ñ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ñ Ð½ÐµÐ·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð° (MongoDB Ð½Ðµ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð² ÑÑ‚Ð¾Ð¼ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ðµ)
- **ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ**: Ð¿Ð¾Ð¸ÑÐº ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð² Ð¿Ð¾ Ð¸Ð½Ð´ÐµÐºÑÑƒ Ð£ÐÐŸ

---

## ðŸ“ **Ð‘Ð»Ð¾Ðº 11: ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ**

### **11.1. cURL Ð·Ð°Ð¿Ñ€Ð¾Ñ**
```bash
curl -X POST http://localhost:3000/api/v1/data-uploads/1c-invoices \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -F "file=@/path/to/Ð²Ñ‹Ð³Ñ€ÑƒÐ·ÐºÐ°1c.csv"
```

### **11.2. JavaScript (fetch)**
```javascript
const formData = new FormData();
formData.append('file', fileInput.files[0]);

const response = await fetch('/api/v1/data-uploads/1c-invoices', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${token}`
  },
  body: formData
});

const result = await response.json();
console.log('ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ð¾ ÑÑ‚Ñ€Ð¾Ðº:', result.processedRows);
console.log('ÐžÑˆÐ¸Ð±ÐºÐ¸:', result.errors);
```

### **11.3. Postman**
1. ÐœÐµÑ‚Ð¾Ð´: `POST`
2. URL: `http://localhost:3000/api/v1/data-uploads/1c-invoices`
3. Headers: `Authorization: Bearer {token}`
4. Body â†’ form-data:
   - Key: `file` (Ñ‚Ð¸Ð¿: File)
   - Value: Ð²Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ CSV Ñ„Ð°Ð¹Ð»

---

## ðŸ” **Ð‘Ð»Ð¾Ðº 12: ÐžÑ‚Ð»Ð°Ð´ÐºÐ° Ð¸ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³**

### **12.1. Ð›Ð¾Ð³Ð¸ Ð´Ð»Ñ Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð½Ð¸Ñ**
- Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð²: `"Row {N}: Created new customer '{name}' (Ð£ÐÐŸ: {unp})"`
- ÐŸÑ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ñ: `"Row {N}: Customer Ð£ÐÐŸ {unp} found, but name differs"`
- ÐžÑˆÐ¸Ð±ÐºÐ¸ ÑÑ‚Ñ€Ð¾Ðº: `"Error processing row {N}: {error}"`

### **12.2. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð°**
- ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ `processedRows === totalRows - skippedRows`
- ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ `errors.length` Ð´Ð»Ñ Ð²Ñ‹ÑÐ²Ð»ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð½Ñ‹Ñ… ÑÑ‚Ñ€Ð¾Ðº
- Ð¡Ñ€Ð°Ð²Ð½Ð¸Ñ‚ÑŒ `createdCustomers` Ñ Ð¾Ð¶Ð¸Ð´Ð°ÐµÐ¼Ñ‹Ð¼ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾Ð¼ Ð½Ð¾Ð²Ñ‹Ñ… ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð²

### **12.3. Ð¢Ð¸Ð¿Ð¸Ñ‡Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹**
1. **ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð°Ñ ÐºÐ¾Ð´Ð¸Ñ€Ð¾Ð²ÐºÐ° CSV** â†’ ÑƒÐ±ÐµÐ´Ð¸Ñ‚ÑŒÑÑ, Ñ‡Ñ‚Ð¾ Ñ„Ð°Ð¹Ð» Ð² UTF-8
2. **ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ðµ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¸** â†’ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ñ‚Ð¾Ñ‡Ð½Ð¾Ðµ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ðµ (Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€, Ð¿Ñ€Ð¾Ð±ÐµÐ»Ñ‹)
3. **ÐÐµÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ðµ Ð´Ð°Ñ‚Ñ‹** â†’ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÐ¼Ñ‹Ðµ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ñ‹
4. **Ð”ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ñ‹ ÑÑ‡ÐµÑ‚Ð¾Ð²** â†’ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾ `invoiceNumber + customerId`

---

## ðŸ“š **Ð¡Ð²ÑÐ·Ð°Ð½Ð½Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹**

### **ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹**
- `src/infrastructure/web/express/routes/data-upload.routes.ts` - Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ
- `src/infrastructure/web/express/controllers/data-upload.controller.ts` - ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€
- `src/infrastructure/web/express/middlewares/upload.middleware.ts` - Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ñ„Ð°Ð¹Ð»Ð¾Ð²
- `src/application/use-cases/data-uploads/process-1c-invoice-upload.use-case.ts` - Ð±Ð¸Ð·Ð½ÐµÑ-Ð»Ð¾Ð³Ð¸ÐºÐ°
- `src/application/dtos/data-uploads/invoice-1c-row.dto.ts` - DTO Ð´Ð»Ñ ÑÑ‚Ñ€Ð¾Ðº CSV
- `src/application/use-cases/data-uploads/service-type.mapper.ts` - Ð¼Ð°Ð¿Ð¿Ð¸Ð½Ð³ Ñ‚Ð¸Ð¿Ð¾Ð² ÑƒÑÐ»ÑƒÐ³

### **Ð ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¸**
- `src/domain/repositories/ICustomerRepository.ts` - Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð²
- `src/domain/repositories/IInvoiceRepository.ts` - Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ ÑÑ‡ÐµÑ‚Ð¾Ð²
- `src/infrastructure/database/mongoose/repositories/customer.repository.ts` - Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ
- `src/infrastructure/database/mongoose/repositories/invoice.repository.ts` - Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ

### **Ð¡ÑƒÑ‰Ð½Ð¾ÑÑ‚Ð¸**
- `src/domain/entities/customer.entity.ts` - ÑÑƒÑ‰Ð½Ð¾ÑÑ‚ÑŒ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°
- `src/domain/entities/invoice.entity.ts` - ÑÑƒÑ‰Ð½Ð¾ÑÑ‚ÑŒ ÑÑ‡ÐµÑ‚Ð°

---

## âœ… **Ð§ÐµÐºÐ»Ð¸ÑÑ‚ Ð´Ð»Ñ Ð¿Ð¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ¸ CSV Ñ„Ð°Ð¹Ð»Ð°**

- [ ] Ð¤Ð°Ð¹Ð» ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½ Ð² Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ CSV (`.csv`)
- [ ] ÐšÐ¾Ð´Ð¸Ñ€Ð¾Ð²ÐºÐ°: UTF-8
- [ ] ÐŸÐµÑ€Ð²Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ° ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¸
- [ ] Ð’ÑÐµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¸ Ð¿Ñ€Ð¸ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‚
- [ ] Ð”Ð°Ñ‚Ñ‹ Ð² Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÐ¼Ð¾Ð¼ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ (`dd.MM.yyyy` Ð¸Ð»Ð¸ `yyyy-MM-dd`)
- [ ] Ð¡ÑƒÐ¼Ð¼Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ Ñ‚Ð¾Ñ‡ÐºÑƒ Ð¸Ð»Ð¸ Ð·Ð°Ð¿ÑÑ‚ÑƒÑŽ ÐºÐ°Ðº Ñ€Ð°Ð·Ð´ÐµÐ»Ð¸Ñ‚ÐµÐ»ÑŒ Ð´Ñ€Ð¾Ð±Ð½Ð¾Ð¹ Ñ‡Ð°ÑÑ‚Ð¸
- [ ] Ð£ÐÐŸ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð² Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ñ‹ Ð¸ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹
- [ ] ÐÐ¾Ð¼ÐµÑ€Ð° Ð°ÐºÑ‚Ð¾Ð² ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹ Ð² Ñ€Ð°Ð¼ÐºÐ°Ñ… Ð¾Ð´Ð½Ð¾Ð³Ð¾ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°
- [ ] Ð Ð°Ð·Ð¼ÐµÑ€ Ñ„Ð°Ð¹Ð»Ð° Ð½Ðµ Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐ°ÐµÑ‚ 10 ÐœÐ‘

---

*Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚ ÑÐ¾Ð·Ð´Ð°Ð½ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° ÐºÐ¾Ð´Ð¾Ð²Ð¾Ð¹ Ð±Ð°Ð·Ñ‹ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° ShnurAA_214371_RIOPK_Server*

