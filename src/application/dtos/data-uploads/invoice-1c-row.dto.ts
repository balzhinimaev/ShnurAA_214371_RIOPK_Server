// src/application/dtos/data-uploads/invoice-1c-row.dto.ts
import Papa from 'papaparse';

/**
 * DTO для строки CSV из выгрузки 1С (выгрузка1c.csv)
 * Соответствует структуре файла с дебиторской задолженностью
 */
export interface Invoice1cCsvRowDto {
    Дата_начала_услуги: string; // Дата начала оказания услуги
    Дата_окончания_услуги: string; // Дата окончания услуги
    Номер_акта: string; // Номер акта (используем как invoiceNumber)
    Контрагент: string; // Название контрагента
    ИНН: string; // ИНН контрагента
    Договор: string; // Номер договора
    Тип_услуги: string; // Тип услуги (Сопровождение ПКТ, Установка ККТ и т.д.)
    Сумма_к_оплате: string; // Общая сумма счета
    Срок_оплаты_дней: string; // Срок оплаты в днях
    Дата_планируемой_оплаты: string; // Планируемая дата оплаты (dueDate)
    Сумма_оплачено: string; // Оплаченная сумма
    Дата_фактической_оплаты?: string; // Дата фактической оплаты (опционально)
    Остаток_задолженности: string; // Остаток долга
    Менеджер?: string; // Ответственный менеджер
    Примечание?: string; // Примечания/комментарии
}

/**
 * Тип для результата парсинга CSV из 1С
 */
export type Parsed1cInvoicesResult = {
    data: Invoice1cCsvRowDto[];
    errors: Papa.ParseError[];
    meta: Papa.ParseMeta;
};

