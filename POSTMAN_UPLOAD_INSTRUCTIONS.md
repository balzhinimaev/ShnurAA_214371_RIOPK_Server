# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ Postman

## –ü—Ä–æ–±–ª–µ–º–∞ "Unexpected field"

–û—à–∏–±–∫–∞ `MulterError: Unexpected field` –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –∫–æ–≥–¥–∞ –∏–º—è –ø–æ–ª—è –≤ –∑–∞–ø—Ä–æ—Å–µ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–º, —á—Ç–æ –æ–∂–∏–¥–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä.

**–°–µ—Ä–≤–µ—Ä –æ–∂–∏–¥–∞–µ—Ç –∏–º—è –ø–æ–ª—è: `file`**

## –î–æ—Å—Ç—É–ø–Ω—ã–µ Endpoints

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—ã—á–Ω—ã—Ö CSV —Ñ–∞–π–ª–æ–≤ (–∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏)

**Endpoint:** `POST /api/v1/data-uploads/invoices`

**–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:**
```csv
InvoiceNumber,CustomerName,CustomerUNP,IssueDate,DueDate,TotalAmount,PaidAmount
INV-001,–û–û–û –ü—Ä–∏–º–µ—Ä,1234567890,2024-01-01,2024-01-31,10000,5000
```

**‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π–ª `invoices_english.csv` –¥–ª—è —ç—Ç–æ–≥–æ endpoint**

### 2. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ —Ñ–æ—Ä–º–∞—Ç–∞ 1C (—Ä—É—Å—Å–∫–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏)

**Endpoint:** `POST /api/v1/data-uploads/1c-invoices`

**–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:**
```csv
–î–∞—Ç–∞_–Ω–∞—á–∞–ª–∞_—É—Å–ª—É–≥–∏,–î–∞—Ç–∞_–æ–∫–æ–Ω—á–∞–Ω–∏—è_—É—Å–ª—É–≥–∏,–ù–æ–º–µ—Ä_–∞–∫—Ç–∞,–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç,–ò–ù–ù,–î–æ–≥–æ–≤–æ—Ä,–¢–∏–ø_—É—Å–ª—É–≥–∏,–°—É–º–º–∞_–∫_–æ–ø–ª–∞—Ç–µ,–°—Ä–æ–∫_–æ–ø–ª–∞—Ç—ã_–¥–Ω–µ–π,–î–∞—Ç–∞_–ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–π_–æ–ø–ª–∞—Ç—ã,–°—É–º–º–∞_–æ–ø–ª–∞—á–µ–Ω–æ,–î–∞—Ç–∞_—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π_–æ–ø–ª–∞—Ç—ã,–û—Å—Ç–∞—Ç–æ–∫_–∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏,–ú–µ–Ω–µ–¥–∂–µ—Ä,–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ
2024-07-01,2024-07-31,–ê–ö–¢-2024-0234,–û–û–û "–ê–ª—å—Ñ–∞–¢–æ—Ä–≥",123456789,–î-2023-045,–°–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ –ü–ö–¢,15000,30,2024-08-30,15000,2024-08-25,0,–ò–≤–∞–Ω–æ–≤–∞ –ú.–ü.,–û–ø–ª–∞—á–µ–Ω–æ –≤ —Å—Ä–æ–∫
```

**‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π–ª `–≤—ã–≥—Ä—É–∑–∫–∞1c.csv` –¥–ª—è —ç—Ç–æ–≥–æ endpoint**

## ‚ö†Ô∏è –í–ê–ñ–ù–û: –í—ã–±–æ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ endpoint

| –§–∞–π–ª | Endpoint | –ü—Ä–∏—á–∏–Ω–∞ |
|------|----------|---------|
| `invoices_english.csv` | `/api/v1/data-uploads/invoices` | –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ |
| `–≤—ã–≥—Ä—É–∑–∫–∞1c.csv` | `/api/v1/data-uploads/1c-invoices` | –†—É—Å—Å–∫–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (—Ñ–æ—Ä–º–∞—Ç 1C) |

**–ï—Å–ª–∏ –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –æ—à–∏–±–∫—É "–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏"**, –∑–Ω–∞—á–∏—Ç –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π endpoint!

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –≤ Postman

### –®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å

1. –û—Ç–∫—Ä–æ–π—Ç–µ Postman
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å: **POST**
3. **URL (–≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π):**
   - `http://localhost:3000/api/v1/data-uploads/invoices` (–¥–ª—è —Ñ–∞–π–ª–∞ `invoices_english.csv`)
   - `http://localhost:3000/api/v1/data-uploads/1c-invoices` (–¥–ª—è —Ñ–∞–π–ª–∞ `–≤—ã–≥—Ä—É–∑–∫–∞1c.csv`)

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Authorization**
2. Type: **Bearer Token**
3. Token: `<–≤–∞—à_JWT_—Ç–æ–∫–µ–Ω>`

–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω, —Å–Ω–∞—á–∞–ª–∞ –∞–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ endpoint `/api/v1/auth/login`

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Body (–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û!)

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Body**
2. –í—ã–±–µ—Ä–∏—Ç–µ **form-data** (–ù–ï binary!)
3. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª–µ:
   - **Key:** `file` ‚ö†Ô∏è **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ò–ú–ï–ù–ù–û `file`!**
   - –¢–∏–ø –ø–æ–ª—è: –≤—ã–±–µ—Ä–∏—Ç–µ **File** (—Å–ø—Ä–∞–≤–∞ –æ—Ç –ø–æ–ª—è Key –µ—Å—Ç—å –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫)
   - **Value:** –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à —Ñ–∞–π–ª `–≤—ã–≥—Ä—É–∑–∫–∞1c.csv`

### –®–∞–≥ 4: –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å

–ù–∞–∂–º–∏—Ç–µ **Send**

## –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

### ‚ùå –û—à–∏–±–∫–∞: "Unexpected field"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è –ø–æ–ª—è

**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
- –í Body –≤—ã–±—Ä–∞–Ω **form-data** (–Ω–µ binary!)
- –ò–º—è –ø–æ–ª—è —Ç–æ—á–Ω–æ `file` (lowercase)
- –¢–∏–ø –ø–æ–ª—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ **File**

### ‚ùå –û—à–∏–±–∫–∞: 401 Unauthorized

**–ü—Ä–∏—á–∏–Ω–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–π JWT —Ç–æ–∫–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:** 
1. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ `/api/v1/auth/login`
2. –î–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ Authorization ‚Üí Bearer Token

### ‚ùå –û—à–∏–±–∫–∞: 403 Forbidden

**–ü—Ä–∏—á–∏–Ω–∞:** –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø—Ä–∞–≤

**–†–µ—à–µ–Ω–∏–µ:** –î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ –Ω—É–∂–Ω–∞ —Ä–æ–ª—å `ADMIN` –∏–ª–∏ `ANALYST`

### ‚ùå –û—à–∏–±–∫–∞: "–§–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω"

**–ü—Ä–∏—á–∏–Ω–∞:** –§–∞–π–ª –Ω–µ –±—ã–ª –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø –ø–æ–ª—è

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—ã–±—Ä–∞–Ω —Ñ–∞–π–ª
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∏–ø –ø–æ–ª—è –∏–º–µ–Ω–Ω–æ **File**, –∞ –Ω–µ **Text**

## –ü—Ä–∏–º–µ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –≤ Postman

```
POST http://localhost:3000/api/v1/data-uploads/1c-invoices

Headers:
  Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

Body (form-data):
  file: [–≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –≤—ã–≥—Ä—É–∑–∫–∞1c.csv]
       ‚Üë
       –¢–∏–ø: File (–Ω–µ Text!)
```

## –û–∂–∏–¥–∞–µ–º—ã–π —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç

```json
{
  "message": "–§–∞–π–ª 1C —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω.",
  "totalRows": 25,
  "successfullyProcessed": 23,
  "skipped": 2,
  "errors": [
    "–°—Ç—Ä–æ–∫–∞ 5: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã",
    "–°—Ç—Ä–æ–∫–∞ 12: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –£–ù–ü"
  ]
}
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞:** 10 MB
- **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:** .csv
- **–ö–æ–¥–∏—Ä–æ–≤–∫–∞:** UTF-8
- **–†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –≤ CSV:** –∑–∞–ø—è—Ç–∞—è (,)

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞

–ï—Å–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç–µ –∏—Å–ø—ã—Ç—ã–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω:**
   ```bash
   npm run dev
   ```

2. **–ü–∞–ø–∫–∞ uploads —Å—É—â–µ—Å—Ç–≤—É–µ—Ç** (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ)

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—à–∏–±–æ–∫

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- –ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ / Postman Console –¥–ª—è –¥–µ—Ç–∞–ª–µ–π –æ—à–∏–±–∫–∏
- –õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `–≤—ã–≥—Ä—É–∑–∫–∞1c.csv` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É

---

## üìã –ö—Ä–∞—Ç–∫–∞—è –®–ø–∞—Ä–≥–∞–ª–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –§–∞–π–ª —Å –∞–Ω–≥–ª–∏–π—Å–∫–∏–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏

```
–§–∞–π–ª: invoices_english.csv
Endpoint: POST /api/v1/data-uploads/invoices
Body: form-data, key="file", type=File
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –§–∞–π–ª —Ñ–æ—Ä–º–∞—Ç–∞ 1C (—Ä—É—Å—Å–∫–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏)

```
–§–∞–π–ª: –≤—ã–≥—Ä—É–∑–∫–∞1c.csv
Endpoint: POST /api/v1/data-uploads/1c-invoices
Body: form-data, key="file", type=File
```

### –û–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Ç—Ä–µ–±—É—é—Ç:
- ‚úÖ Authorization: Bearer Token
- ‚úÖ –†–æ–ª—å: ADMIN –∏–ª–∏ ANALYST
- ‚úÖ –ò–º—è –ø–æ–ª—è: **`file`** (lowercase!)
- ‚úÖ –¢–∏–ø –ø–æ–ª—è: **File** (–Ω–µ Text!)
- ‚úÖ Body —Ç–∏–ø: **form-data** (–Ω–µ binary!)

